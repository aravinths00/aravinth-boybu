{"version":3,"sources":["webpack://@aravinth/boybu/webpack/bootstrap","webpack://@aravinth/boybu/./forum.js","webpack://@aravinth/boybu/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://@aravinth/boybu/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@aravinth/boybu/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@aravinth/boybu/./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack://@aravinth/boybu/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@aravinth/boybu/./src/forum/events/RecipientLeft.js","webpack://@aravinth/boybu/./src/forum/events/RecipientsModified.js","webpack://@aravinth/boybu/./src/forum/events/index.js","webpack://@aravinth/boybu/./src/forum/extend/Discussion.js","webpack://@aravinth/boybu/./src/forum/extend/SettingsPage.js","webpack://@aravinth/boybu/./src/forum/extend/User.js","webpack://@aravinth/boybu/./src/forum/extend/index.js","webpack://@aravinth/boybu/./src/forum/index.js","webpack://@aravinth/boybu/./src/forum/modals/AddRecipientModal.js","webpack://@aravinth/boybu/./src/forum/modals/index.js","webpack://@aravinth/boybu/./src/forum/notifications/PrivateDiscussionAddedNotification.js","webpack://@aravinth/boybu/./src/forum/notifications/PrivateDiscussionNotification.js","webpack://@aravinth/boybu/./src/forum/notifications/PrivateDiscussionReplyNotification.js","webpack://@aravinth/boybu/./src/forum/notifications/PrivateDiscussionUserLeftNotification.js","webpack://@aravinth/boybu/./src/forum/notifications/index.js","webpack://@aravinth/boybu/./src/forum/pages/PrivateComposing.js","webpack://@aravinth/boybu/./src/forum/pages/PrivateDiscussionsPage.js","webpack://@aravinth/boybu/./src/forum/pages/PrivateDiscussionsUserPage.js","webpack://@aravinth/boybu/./src/forum/pages/discussions/PrivateDiscussionComposer.js","webpack://@aravinth/boybu/./src/forum/pages/discussions/PrivateDiscussionList.js","webpack://@aravinth/boybu/./src/forum/pages/discussions/index.js","webpack://@aravinth/boybu/./src/forum/pages/index.js","webpack://@aravinth/boybu/./src/forum/pages/labels/RecipientLabel.tsx","webpack://@aravinth/boybu/./src/forum/pages/labels/recipientCountLabel.js","webpack://@aravinth/boybu/./src/forum/pages/labels/recipientsLabels.tsx","webpack://@aravinth/boybu/./src/forum/pages/routes.js","webpack://@aravinth/boybu/./src/forum/search/RecipientSearch.js","webpack://@aravinth/boybu/./src/forum/search/sources/GroupSearchSource.js","webpack://@aravinth/boybu/./src/forum/search/sources/UserSearchSource.js","webpack://@aravinth/boybu/./src/forum/states/PrivateDiscussionListState.js","webpack://@aravinth/boybu/external \"flarum.core.compat['common/Component']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/Model']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/components/Badge']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/components/Button']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/components/Dropdown']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/components/LinkButton']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/components/Modal']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/components/Switch']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/components/Tooltip']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/extend']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/helpers/avatar']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/helpers/highlight']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/helpers/listItems']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/helpers/username']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/models/Discussion']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/models/Group']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/models/User']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/utils/ItemList']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/utils/Stream']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/utils/classList']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['common/utils/extractText']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/app']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/DiscussionHero']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/EventPost']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/LogInModal']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/Notification']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/NotificationGrid']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/Search']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/components/UserPage']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/states/SearchState']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@aravinth/boybu/external \"flarum.core.compat['forum/utils/UserControls']\""],"names":["_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","Constructor","protoProps","staticProps","prototype","_extends","assign","arguments","source","hasOwnProperty","call","apply","_inheritsLoose","subClass","superClass","create","constructor","setPrototypeOf","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","_setPrototypeOf","o","p","__proto__","RecipientLeft","initAttrs","attrs","icon","app","forum","data","attributes","descriptionKey","EventPost","RecipientsModified","diff","diff1","diff2","store","filter","item","map","id","getById","content","post","oldRecipients","newRecipients","added","removed","usersAdded","usersRemoved","groupsAdded","groupsRemoved","concat","localeBase","descriptionData","recipientsLabel","link","postComponents","recipientsModified","recipientLeft","badges","index","hero","apiInclude","controls","add","discussion","items","long","recipients","recipientUsers","recipientGroups","extend","Discussion","Badge","component","type","label","translator","trans","DiscussionListItem","DiscussionHero","DiscussionListState","params","include","push","DiscussionControls","canEditRecipients","Button","onclick","modal","show","AddRecipientModal","find","user","session","ItemList","toArray","forEach","recipient","User","Group","save","relationships","then","history","back","Model","hasMany","oldRecipientUsers","oldRecipientGroups","attribute","canEditUserRecipients","canEditGroupRecipients","isPrivateDiscussion","privacyToggle","SettingsPage","Switch","state","blocksPd","onchange","value","blocksPdLoading","m","redraw","loading","message","sharedMessageHistory","UserControls","cannotBeDirectMessaged","e","preventDefault","Promise","resolve","PrivateDiscussionComposer","composer","load","titlePlaceholder","submitLabel","username","UserPage","href","route","get","LinkButton","unreadPrivateMessagesCount","initializers","events","pages","notifications","oninit","vnode","selected","Stream","assignInitialRecipients","selectedRecipients","merge","recipientSearch","SearchState","isDismissible","group","className","title","helpText","RecipientSearch","hide","bind","select","metaKey","ctrlKey","$","submit","onsubmit","current","DiscussionPage","stream","update","close","Modal","modals","PrivateDiscussionAddedNotification","notification","subject","fromUser","Notification","PrivateDiscussionNotification","PrivateDiscussionReplyNotification","postNumber","PrivateDiscussionUserLeftNotification","notificationComponents","boybuPrivateDiscussionCreated","boybuPrivateDiscussionReplied","PrivateDiscussionRepliedNotification","boybuRecipientRemoved","boybuPrivateDiscussionAdded","grid","NotificationGrid","name","PrivateComposing","action","reject","LogInModal","itemClassName","disabled","canStartDiscussion","IndexPage","setTitle","q","compose","replace","PrivateDiscussionsUserPage","changeSort","list","PrivateDiscussionListState","sort","refresh","handleChangeSort","loadUser","param","listItems","actionItems","viewItems","composing","sortMap","sortOptions","Dropdown","buttonClassName","active","_isByobuComposer","fields","addDefaultRecipients","users","groups","undefined","chooseRecipients","focus","headerItems","recipientCountLabel","getBy","createRecord","cache","discussionList","set","loaded","DiscussionComposer","PrivateDiscussionList","DiscussionList","discussions","routes","PrivateDiscussionsPage","RecipientLabel","view","newAttrs","style","classList","namePlural","Component","count","otherAttrs","boybuUserPrivate","path","boybuPrivate","inputUuid","Math","random","toString","substring","oncreate","$search","on","addRecipient","parentNode","clearTimeout","typingTimer","doSearch","setTimeout","getValue","setValue","sources","sourceItems","removeRecipient","open","focused","loadingSources","dom","extractText","hasFocus","LoadingIndicator","size","UserSearchSource","GroupSearchSource","values","split","findRecipient","clear","remove","Search","search","query","page","limit","toLowerCase","results","all","substr","groupName","highlight","boybuResults","pushResults","children","text","avatar","payload","result"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","export * from './src/forum';\n","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import EventPost from 'flarum/forum/components/EventPost';\n\nexport default class RecipientLeft extends EventPost {\n    static initAttrs(attrs) {\n        super.initAttrs(attrs);\n    }\n\n    icon() {\n        return app.forum.data.attributes['boybu.icon-postAction'];\n    }\n\n    descriptionKey() {\n        return 'aravinth-boybu.forum.post.recipients_modified.removed_self';\n    }\n}\n","import EventPost from 'flarum/forum/components/EventPost';\nimport recipientsLabel from '../pages/labels/recipientsLabels';\n\nexport default class RecipientsModified extends EventPost {\n    static initAttrs(attrs) {\n        super.initAttrs(attrs);\n\n        function diff(diff1, diff2, store) {\n            return diff1.filter((item) => diff2.indexOf(item) === -1).map((id) => app.store.getById(store, id));\n        }\n\n        const content = attrs.post.content();\n\n        // For event posts existing before groups functionality.\n        if (!content['new'] && content.length == 2) {\n            const oldRecipients = attrs.post.content()[0];\n            const newRecipients = attrs.post.content()[1];\n            attrs.added = diff(newRecipients, oldRecipients, 'users');\n            attrs.removed = diff(oldRecipients, newRecipients, 'users');\n        } else {\n            let usersAdded = diff(content['new']['users'], content['old']['users'], 'users');\n            let usersRemoved = diff(content['old']['users'], content['new']['users'], 'users');\n            let groupsAdded = diff(content['new']['groups'], content['old']['groups'], 'groups');\n            let groupsRemoved = diff(content['old']['groups'], content['new']['groups'], 'groups');\n\n            attrs.added = usersAdded.concat(groupsAdded);\n            attrs.removed = usersRemoved.concat(groupsRemoved);\n        }\n    }\n\n    icon() {\n        return app.forum.data.attributes['boybu.icon-postAction'];\n    }\n\n    descriptionKey() {\n        var localeBase = 'aravinth-boybu.forum.post.recipients_modified.';\n\n        if (this.attrs.added.length) {\n            if (this.attrs.removed.length) {\n                return localeBase + 'added_and_removed';\n            }\n\n            return localeBase + 'added';\n        }\n\n        return localeBase + 'removed';\n    }\n\n    descriptionData() {\n        const data = {};\n\n        if (this.attrs.added.length) {\n            data.added = recipientsLabel(this.attrs.added, { link: true });\n        }\n\n        if (this.attrs.removed.length) {\n            data.removed = recipientsLabel(this.attrs.removed, { link: true });\n        }\n\n        return data;\n    }\n}\n","import RecipientLeft from './RecipientLeft';\nimport RecipientsModified from './RecipientsModified';\n\nexport default (app) => {\n    app.postComponents.recipientsModified = RecipientsModified;\n    app.postComponents.recipientLeft = RecipientLeft;\n};\n","import { extend } from 'flarum/common/extend';\nimport Model from 'flarum/common/Model';\nimport Badge from 'flarum/common/components/Badge';\nimport Discussion from 'flarum/common/models/Discussion';\nimport User from 'flarum/common/models/User';\nimport Group from 'flarum/common/models/Group';\nimport Button from 'flarum/common/components/Button';\nimport DiscussionListItem from 'flarum/forum/components/DiscussionListItem';\nimport DiscussionHero from 'flarum/forum/components/DiscussionHero';\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\nimport recipientsLabel from '../pages/labels/recipientsLabels';\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport AddRecipientModal from './../modals/AddRecipientModal';\n\nexport default () => {\n    attributes();\n    badges();\n    index();\n    hero();\n    apiInclude();\n    controls();\n};\n\nconst add = function (discussion, items, long) {\n    let recipients = [];\n\n    if (discussion.recipientUsers().length) {\n        recipients = recipients.concat(discussion.recipientUsers());\n    }\n\n    if (discussion.recipientGroups().length) {\n        recipients = recipients.concat(discussion.recipientGroups());\n    }\n\n    if (recipients && recipients.length) {\n        if (long) {\n            items.add('recipients', recipientsLabel(recipients), 10);\n        } else {\n            items.add('recipients', recipientsLabel(recipients, { link: true }), 4);\n        }\n    }\n};\n\nfunction badges() {\n    extend(Discussion.prototype, 'badges', function (badges) {\n        if (this.recipientUsers().length || this.recipientGroups().length) {\n            badges.add(\n                'private',\n                Badge.component({\n                    type: 'private',\n                    label: app.translator.trans('aravinth-boybu.forum.badges.is_private.tooltip'),\n                    icon: app.forum.data.attributes['boybu.icon-badge'],\n                }),\n                10\n            );\n        }\n    });\n}\n\nfunction index() {\n    extend(DiscussionListItem.prototype, 'infoItems', function (items) {\n        const discussion = this.attrs.discussion;\n\n        add(discussion, items, true);\n    });\n}\n\nfunction hero() {\n    extend(DiscussionHero.prototype, 'items', function (items) {\n        const discussion = this.attrs.discussion;\n\n        add(discussion, items, false);\n    });\n}\n\nfunction apiInclude() {\n    extend(DiscussionListState.prototype, 'requestParams', function (params) {\n        params.include.push('recipientUsers');\n        params.include.push('recipientGroups');\n    });\n}\n\nfunction controls() {\n    extend(DiscussionControls, 'moderationControls', function (items, discussion) {\n        if (discussion.canEditRecipients()) {\n            items.add(\n                'recipients',\n                Button.component(\n                    {\n                        icon: app.forum.data.attributes['boybu.icon-badge'],\n                        onclick: () => app.modal.show(AddRecipientModal, { discussion }),\n                    },\n                    app.translator.trans('aravinth-boybu.forum.buttons.edit_recipients')\n                )\n            );\n        }\n        if (discussion && discussion.recipientUsers().find((user) => user.id() === app.session.user.id())) {\n            items.add(\n                'remove',\n                Button.component(\n                    {\n                        icon: 'fas fa-user-slash',\n                        onclick: () => {\n                            if (discussion) {\n                                let recipients = new ItemList();\n                                discussion.recipientUsers().map((user) => {\n                                    if (app.session.user.id() !== user.id()) {\n                                        recipients.add('users:' + user.id(), user);\n                                    }\n                                });\n\n                                let recipientGroups = [];\n                                let recipientUsers = [];\n\n                                recipients.toArray().forEach((recipient) => {\n                                    if (recipient instanceof User) {\n                                        recipientUsers.push(recipient);\n                                    }\n                                    if (recipient instanceof Group) {\n                                        recipientGroups.push(recipient);\n                                    }\n                                });\n\n                                discussion\n                                    .save({\n                                        relationships: {\n                                            recipientUsers,\n                                            recipientGroups,\n                                        },\n                                    })\n                                    .then(() => app.history.back());\n                            }\n                        },\n                    },\n                    app.translator.trans('aravinth-boybu.forum.buttons.remove_from_discussion')\n                )\n            );\n        }\n    });\n}\n\nfunction attributes() {\n    Discussion.prototype.recipientUsers = Model.hasMany('recipientUsers');\n    Discussion.prototype.oldRecipientUsers = Model.hasMany('oldRecipientUsers');\n    Discussion.prototype.recipientGroups = Model.hasMany('recipientGroups');\n    Discussion.prototype.oldRecipientGroups = Model.hasMany('oldRecipientGroups');\n\n    Discussion.prototype.canEditRecipients = Model.attribute('canEditRecipients');\n    Discussion.prototype.canEditUserRecipients = Model.attribute('canEditUserRecipients');\n    Discussion.prototype.canEditGroupRecipients = Model.attribute('canEditGroupRecipients');\n    Discussion.prototype.canEditGroupRecipients = Model.attribute('canEditGroupRecipients');\n\n    Discussion.prototype.isPrivateDiscussion = Model.attribute('isPrivateDiscussion');\n}\n","import { extend } from 'flarum/common/extend';\nimport SettingsPage from 'flarum/forum/components/SettingsPage';\nimport Switch from 'flarum/common/components/Switch';\n\nexport default (app) => {\n    privacyToggle(app);\n};\n\nfunction privacyToggle(app) {\n    extend(SettingsPage.prototype, 'privacyItems', function (items) {\n        items.add(\n            'boybu-block-dm',\n            Switch.component(\n                {\n                    state: this.user.blocksPd(),\n                    onchange: (value) => {\n                        this.blocksPdLoading = true;\n\n                        this.user.save({ blocksPd: value }).then(() => {\n                            this.blocksPdLoading = false;\n                            m.redraw();\n                        });\n                    },\n                    loading: this.blocksPdLoading,\n                },\n                app.translator.trans('aravinth-boybu.forum.user.settings.block_pd')\n            )\n        );\n    });\n}\n","import { extend } from 'flarum/common/extend';\nimport Model from 'flarum/common/Model';\nimport User from 'flarum/common/models/User';\nimport UserControls from 'flarum/forum/utils/UserControls';\nimport PrivateDiscussionComposer from './../pages/discussions/PrivateDiscussionComposer';\nimport Button from 'flarum/common/components/Button';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\n\nexport default (app) => {\n    attributes();\n    message(app);\n    sharedMessageHistory(app);\n};\n\nfunction message(app) {\n    extend(UserControls, 'userControls', function (items, user) {\n        if (\n            app.session.user &&\n            app.session.user.id() !== user.id() &&\n            app.forum.attribute('canStartPrivateDiscussion') &&\n            (user.blocksPd() === false || (app.forum.attribute('canStartPrivateDiscussionWithBlockers') && user.cannotBeDirectMessaged()))\n        ) {\n            items.add(\n                'private-discussion',\n                Button.component(\n                    {\n                        icon: app.forum.data.attributes['boybu.icon-badge'],\n                        onclick: (e) => {\n                            e.preventDefault();\n\n                            return new Promise((resolve) => {\n                                let recipients = new ItemList();\n                                recipients.add('users:' + app.session.user.id(), app.session.user);\n                                recipients.add('users:' + user.id(), user);\n\n                                PrivateDiscussionComposer.prototype.recipients = recipients;\n\n                                app.composer.load(PrivateDiscussionComposer, {\n                                    user: app.session.user,\n                                    recipients: recipients,\n                                    recipientUsers: recipients,\n                                    titlePlaceholder: app.translator.trans('aravinth-boybu.forum.composer_private_discussion.title_placeholder'),\n                                    submitLabel: app.translator.trans('aravinth-boybu.forum.composer_private_discussion.submit_button'),\n                                });\n                                app.composer.show();\n\n                                return resolve(app.composer);\n                            });\n                        },\n                    },\n                    app.translator.trans('aravinth-boybu.forum.buttons.send_pd', { username: user.username() })\n                )\n            );\n        }\n\n        return items;\n    });\n}\n\nfunction sharedMessageHistory(app) {\n    extend(UserPage.prototype, 'navItems', function (items) {\n        const href = app.route('boybuUserPrivate', { username: this.user.username() });\n\n        // Hide links from guests if they are not already on the page\n        if (!app.session.user && m.route.get() !== href) return;\n        // Hide link for your own page.\n        if (app.session.user && app.session.user.username() === this.user.username()) return;\n\n        items.add(\n            'boybu',\n            LinkButton.component(\n                {\n                    href,\n                    icon: app.forum.data.attributes['boybu.icon-badge'],\n                },\n                app.translator.trans('aravinth-boybu.forum.user.boybu_link')\n            ),\n            85\n        );\n    });\n}\n\nfunction attributes() {\n    User.prototype.blocksPd = Model.attribute('blocksPd');\n    User.prototype.cannotBeDirectMessaged = Model.attribute('cannotBeDirectMessaged');\n    User.prototype.unreadPrivateMessagesCount = Model.attribute('unreadPrivateMessagesCount');\n}\n","import SettingsPage from './SettingsPage';\nimport Discussion from './Discussion';\nimport User from './User';\n\nexport default (app) => {\n    Discussion(app);\n    SettingsPage(app);\n    User(app);\n};\n","import events from './events';\nimport extend from './extend';\nimport pages from './pages';\nimport notifications from './notifications';\n\nexport * from './modals';\nexport * from './pages/discussions';\n\napp.initializers.add('aravinth-boybu', function (app) {\n    events(app);\n    extend(app);\n\n    pages(app);\n    notifications(app);\n});\n","import Modal from 'flarum/common/components/Modal';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\nimport Button from 'flarum/common/components/Button';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport Stream from 'flarum/common/utils/Stream';\nimport SearchState from 'flarum/forum/states/SearchState';\nimport RecipientSearch from '../search/RecipientSearch';\nimport User from 'flarum/common/models/User';\nimport Group from 'flarum/common/models/Group';\n\nexport default class AddRecipientModal extends Modal {\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.selected = Stream(new ItemList());\n\n        if (this.attrs.discussion) {\n            // Adds recipients of the currently viewed discussion.\n            this.assignInitialRecipients(this.attrs.discussion);\n        } else if (this.attrs.selectedRecipients && this.attrs.selectedRecipients.toArray().length > 0) {\n            // Adds previously selected recipients.\n            this.selected().merge(this.attrs.selectedRecipients);\n        } else {\n            // Adds the current user in case there are no selected recipients yet and this is a new discussion.\n            this.selected().add('users:' + app.session.user.id(), app.session.user);\n        }\n\n        this.recipientSearch = new SearchState();\n    }\n\n    isDismissible() {\n        return false;\n    }\n\n    assignInitialRecipients(discussion) {\n        discussion.recipientUsers().map((user) => {\n            this.selected().add('users:' + user.id(), user);\n        });\n        discussion.recipientGroups().map((group) => {\n            this.selected().add('groups:' + group.id(), group);\n        });\n    }\n\n    className() {\n        return 'AddRecipientModal';\n    }\n\n    title() {\n        return this.attrs.discussion\n            ? app.translator.trans('aravinth-boybu.forum.modal.titles.update_recipients', { title: <em>{this.attrs.discussion.title()}</em> })\n            : app.translator.trans('aravinth-boybu.forum.modal.titles.add_recipients');\n    }\n\n    helpText() {\n        return this.attrs.discussion\n            ? app.translator.trans('aravinth-boybu.forum.modal.help.update_recipients')\n            : app.translator.trans('aravinth-boybu.forum.modal.help.add_recipients');\n    }\n\n    content() {\n        return [\n            <div className=\"Modal-body\">\n                <div class=\"AddRecipientModal-help\">{this.helpText()}</div>\n                <div className=\"AddRecipientModal-form\">\n                    {RecipientSearch.component({\n                        state: this.recipientSearch,\n                        selected: this.selected,\n                        discussion: this.attrs.discussion,\n                    })}\n                    <div className=\"AddRecipientModal-form-submit App-primaryControl\">\n                        {Button.component(\n                            {\n                                type: 'submit',\n                                className: 'Button Button--primary',\n                                icon: 'fas fa-check',\n                            },\n                            app.translator.trans('aravinth-boybu.forum.buttons.submit')\n                        )}\n                        {Button.component(\n                            {\n                                onclick: this.hide.bind(this),\n                                className: 'Button Button--cancel',\n                            },\n                            app.translator.trans('aravinth-boybu.forum.buttons.cancel')\n                        )}\n                    </div>\n                </div>\n            </div>,\n        ];\n    }\n\n    select(e) {\n        // Ctrl + Enter submits the selection, just Enter completes the current entry\n        if (e.metaKey || e.ctrlKey || this.selected.indexOf(this.index) !== -1) {\n            if (this.selected().length) {\n                this.$('form').submit();\n            }\n        }\n    }\n\n    onsubmit(e) {\n        e.preventDefault();\n\n        const discussion = this.attrs.discussion;\n        const recipients = this.selected();\n\n        let recipientGroups = [];\n        let recipientUsers = [];\n\n        recipients.toArray().forEach((recipient) => {\n            if (recipient instanceof User) {\n                recipientUsers.push(recipient);\n            }\n            if (recipient instanceof Group) {\n                recipientGroups.push(recipient);\n            }\n        });\n\n        // Recipients are updated here for existing discussions here.\n        if (discussion) {\n            discussion.save({ relationships: { recipientUsers, recipientGroups } }).then(() => {\n                if (app.current instanceof DiscussionPage) {\n                    app.current.stream.update();\n                }\n                m.redraw();\n            });\n        }\n\n        // Use the onsubmit callback to trigger an update in the DiscussionComposer\n        if (this.attrs.onsubmit) this.attrs.onsubmit(recipients);\n\n        app.modal.close();\n\n        if (!this.attrs.discussion) {\n            app.composer.show();\n        }\n\n        e.redraw = false;\n    }\n}\n","import AddRecipientModal from './AddRecipientModal';\n\nexport const modals = {\n    AddRecipientModal: AddRecipientModal,\n};\n","import Notification from 'flarum/forum/components/Notification';\n\nexport default class PrivateDiscussionAddedNotification extends Notification {\n    icon() {\n        return app.forum.data.attributes['boybu.icon-badge'];\n    }\n\n    href() {\n        const notification = this.attrs.notification;\n        const discussion = notification.subject();\n\n        return app.route.discussion(discussion);\n    }\n\n    content() {\n        const user = this.attrs.notification.fromUser();\n        return app.translator.trans('aravinth-boybu.forum.notifications.pd_added_text', {\n            user: user,\n        });\n    }\n}\n","import Notification from 'flarum/forum/components/Notification';\n\nexport default class PrivateDiscussionNotification extends Notification {\n    icon() {\n        return app.forum.data.attributes['boybu.icon-badge'];\n    }\n\n    href() {\n        const notification = this.attrs.notification;\n        const discussion = notification.subject();\n\n        return app.route.discussion(discussion);\n    }\n\n    content() {\n        const user = this.attrs.notification.fromUser();\n        return app.translator.trans('aravinth-boybu.forum.notifications.pd_text', {\n            user: user,\n        });\n    }\n}\n","import Notification from 'flarum/forum/components/Notification';\n\nexport default class PrivateDiscussionReplyNotification extends Notification {\n    icon() {\n        return 'fas fa-reply';\n    }\n\n    href() {\n        const notification = this.attrs.notification;\n        const discussion = notification.subject();\n        const content = notification.content() || {};\n\n        return app.route.discussion(discussion, content.postNumber);\n    }\n\n    content() {\n        const user = this.attrs.notification.fromUser();\n        return app.translator.trans('aravinth-boybu.forum.notifications.pd_reply_text', {\n            user: user,\n        });\n    }\n}\n","import Notification from 'flarum/forum/components/Notification';\n\nexport default class PrivateDiscussionUserLeftNotification extends Notification {\n    icon() {\n        return app.forum.data.attributes['boybu.icon-badge'];\n    }\n\n    href() {\n        const notification = this.attrs.notification;\n        const discussion = notification.subject();\n\n        return app.route.discussion(discussion);\n    }\n\n    content() {\n        const user = this.attrs.notification.fromUser();\n        return app.translator.trans('aravinth-boybu.forum.notifications.pd_user_left_text', {\n            user: user,\n        });\n    }\n}\n","import { extend } from 'flarum/common/extend';\nimport NotificationGrid from 'flarum/forum/components/NotificationGrid';\nimport PrivateDiscussionNotification from './PrivateDiscussionNotification';\nimport PrivateDiscussionRepliedNotification from './PrivateDiscussionReplyNotification';\nimport PrivateDiscussionUserLeftNotification from './PrivateDiscussionUserLeftNotification';\nimport PrivateDiscussionAddedNotification from './PrivateDiscussionAddedNotification';\n\nexport default function (app) {\n    app.notificationComponents.boybuPrivateDiscussionCreated = PrivateDiscussionNotification;\n    app.notificationComponents.boybuPrivateDiscussionReplied = PrivateDiscussionRepliedNotification;\n    app.notificationComponents.boybuRecipientRemoved = PrivateDiscussionUserLeftNotification;\n    app.notificationComponents.boybuPrivateDiscussionAdded = PrivateDiscussionAddedNotification;\n\n    grid();\n}\n\nfunction grid() {\n    // Add notification preferences.\n    extend(NotificationGrid.prototype, 'notificationTypes', function (items) {\n        items.add('boybuPrivateDiscussionCreated', {\n            name: 'boybuPrivateDiscussionCreated',\n            icon: app.forum.data.attributes['boybu.icon-badge'],\n            label: app.translator.trans('aravinth-boybu.forum.notifications.pd_label'),\n        });\n        items.add('boybuPrivateDiscussionReplied', {\n            name: 'boybuPrivateDiscussionReplied',\n            icon: app.forum.data.attributes['boybu.icon-badge'],\n            label: app.translator.trans('aravinth-boybu.forum.notifications.pd_reply_label'),\n        });\n        items.add('boybuPrivateDiscussionAdded', {\n            name: 'boybuPrivateDiscussionAdded',\n            icon: app.forum.data.attributes['boybu.icon-badge'],\n            label: app.translator.trans('aravinth-boybu.forum.notifications.pd_added_label'),\n        });\n        items.add('boybuRecipientRemoved', {\n            name: 'boybuRecipientRemoved',\n            icon: app.forum.data.attributes['boybu.icon-badge'],\n            label: app.translator.trans('aravinth-boybu.forum.notifications.pd_user_left_label'),\n        });\n    });\n}\n","import Button from 'flarum/common/components/Button';\nimport LogInModal from 'flarum/forum/components/LogInModal';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport PrivateDiscussionComposer from './discussions/PrivateDiscussionComposer';\n\nexport default class PrivateComposing {\n    constructor(recipient) {\n        this.recipient = recipient;\n    }\n\n    action(e) {\n        e.preventDefault();\n\n        return new Promise((resolve, reject) => {\n            if (app.session.user) {\n                let recipients = new ItemList();\n\n                recipients.add('users:' + app.session.user.id(), app.session.user);\n\n                if (this.recipient && app.session.user.id() !== this.recipient.id()) {\n                    recipients.add('users:' + this.recipient.id(), this.recipient);\n                }\n\n                app.composer.load(PrivateDiscussionComposer, {\n                    user: app.session.user,\n                    recipients: recipients,\n                    recipientUsers: recipients,\n                });\n\n                app.composer.show();\n\n                return resolve();\n            } else {\n                app.modal.show(LogInModal);\n\n                return reject();\n            }\n        });\n    }\n\n    component() {\n        return Button.component(\n            {\n                icon: 'fas fa-pen',\n                className: 'Button Button--primary IndexPage-newDiscussion',\n                itemClassName: 'App-primaryControl aravinth-boybu_primaryControl',\n                onclick: this.action.bind(this),\n                disabled: !this.canStartDiscussion,\n            },\n            app.translator.trans(this.canStartDiscussion ? 'aravinth-boybu.forum.nav.start_button' : 'core.forum.index.cannot_start_discussion_button')\n        );\n    }\n\n    get canStartDiscussion() {\n        return app.session.user && app.forum.attribute('canStartPrivateDiscussion');\n    }\n}\n","import { extend } from 'flarum/common/extend';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\nimport PrivateComposing from './PrivateComposing';\n\nexport default (app) => {\n    extend(IndexPage.prototype, 'navItems', (items) => {\n        const user = app.session.user;\n\n        if (user) {\n            items.add(\n                'privateDiscussions',\n                LinkButton.component(\n                    {\n                        icon: app.forum.data.attributes['boybu.icon-badge'],\n                        href: app.route('boybuPrivate'),\n                    },\n                    app.translator.trans('aravinth-boybu.forum.nav.nav_item')\n                ),\n                75\n            );\n        }\n    });\n\n    extend(IndexPage.prototype, 'setTitle', function () {\n        if (app.current.get('routeName') === 'boybuPrivate') {\n            app.setTitle(app.translator.trans('aravinth-boybu.forum.user.dropdown_label'));\n        }\n    });\n\n    extend(DiscussionListState.prototype, 'requestParams', function (params) {\n        if (app.current.get('routeName') === 'boybuPrivate') {\n            params.filter.q = (params.filter.q || '') + ' is:private';\n\n            params.include.push('recipientUsers');\n            params.include.push('recipientGroups');\n        }\n    });\n\n    extend(IndexPage.prototype, 'sidebarItems', function (items) {\n        if (app.current.get('routeName') === 'boybuPrivate') {\n            let compose = new PrivateComposing();\n\n            items.replace('newDiscussion', compose.component());\n        }\n    });\n};\n","import UserPage from 'flarum/forum/components/UserPage';\nimport PrivateDiscussionListState from '../states/PrivateDiscussionListState';\nimport Button from 'flarum/common/components/Button';\nimport Dropdown from 'flarum/common/components/Dropdown';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport listItems from 'flarum/common/helpers/listItems';\nimport PrivateDiscussionList from './discussions/PrivateDiscussionList';\nimport PrivateComposing from './PrivateComposing';\n\nexport default class PrivateDiscussionsUserPage extends UserPage {\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.changeSort('latest');\n    }\n\n    show(user) {\n        // We can not create the list in init because the user will not be available if it has to be loaded asynchronously\n        this.list = new PrivateDiscussionListState({\n            q: `boybu:${user.username()} is:private`,\n            sort: this.sort,\n        });\n\n        this.list.refresh();\n\n        // We call the parent method after creating the list, this way the this.list property\n        // is set before content() is called for the first time\n        super.show(user);\n    }\n\n    handleChangeSort(sort, e) {\n        e.preventDefault();\n\n        this.changeSort(sort);\n    }\n\n    changeSort(sort) {\n        this.sort = sort;\n        this.loadUser(m.route.param('username'));\n    }\n\n    content() {\n        return (\n            <div className=\"DiscussionsUserPage\">\n                <div className=\"DiscussionsUserPage-toolbar\">\n                    <ul className=\"DiscussionsUserPage-toolbar-action\">{listItems(this.actionItems().toArray())}</ul>\n                    <ul className=\"DiscussionsUserPage-toolbar-view\">{listItems(this.viewItems().toArray())}</ul>\n                </div>\n                <PrivateDiscussionList state={this.list}></PrivateDiscussionList>\n            </div>\n        );\n    }\n\n    actionItems() {\n        let composing = new PrivateComposing(this.user);\n\n        const items = new ItemList();\n\n        if (app.session.user && app.forum.attribute('canStartPrivateDiscussion')) {\n            items.add('start_private', composing.component());\n        }\n\n        return items;\n    }\n\n    viewItems() {\n        const items = new ItemList();\n        const sortMap = this.list.sortMap();\n\n        const sortOptions = {};\n        for (const i in sortMap) {\n            sortOptions[i] = app.translator.trans('core.forum.index_sort.' + i + '_button');\n        }\n\n        items.add(\n            'sort',\n            Dropdown.component(\n                {\n                    buttonClassName: 'Button',\n                    label: sortOptions[this.sort] || Object.keys(sortMap).map((key) => sortOptions[key])[0],\n                },\n                Object.keys(sortOptions).map((value) => {\n                    const label = sortOptions[value];\n                    const active = (this.sort || Object.keys(sortMap)[0]) === value;\n\n                    return Button.component(\n                        {\n                            icon: active ? 'fas fa-check' : true,\n                            onclick: this.handleChangeSort.bind(this, value),\n                            active: active,\n                        },\n                        label\n                    );\n                })\n            )\n        );\n\n        return items;\n    }\n}\n","import DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\nimport AddRecipientModal from '../../modals/AddRecipientModal';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport recipientCountLabel from '../labels/recipientCountLabel';\nimport User from 'flarum/common/models/User';\nimport Group from 'flarum/common/models/Group';\n\nexport default class PrivateDiscussionComposer extends DiscussionComposer {\n    /**\n     * Tells other extensions that this composer is a Boybu composer.\n     */\n    _isByobuComposer = true;\n\n    static initAttrs(attrs) {\n        super.initAttrs(attrs);\n\n        attrs.titlePlaceholder = app.translator.trans('aravinth-boybu.forum.composer_private_discussion.title_placeholder');\n        attrs.submitLabel = app.translator.trans('aravinth-boybu.forum.composer_private_discussion.submit_button');\n    }\n\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.composer.fields.recipients = this.attrs.recipients || new ItemList();\n\n        this.composer.fields.recipientUsers = this.attrs.recipientUsers || [];\n        this.composer.fields.recipientGroups = this.attrs.recipientGroups || [];\n\n        const username = m.route.param('username');\n\n        if (typeof username !== 'undefined') {\n            this.addDefaultRecipients(username);\n        }\n    }\n\n    data() {\n        let data = super.data();\n\n        const users = [];\n        const groups = [];\n\n        if (this.composer.fields.recipients !== undefined) {\n            this.composer.fields.recipients.toArray().forEach((recipient) => {\n                if (recipient instanceof User) {\n                    users.push(recipient);\n                }\n\n                if (recipient instanceof Group) {\n                    groups.push(recipient);\n                }\n            });\n        }\n\n        data.relationships = data.relationships || {};\n\n        if (users.length) {\n            data.relationships.recipientUsers = users;\n        }\n\n        if (groups.length) {\n            data.relationships.recipientGroups = groups;\n        }\n\n        return data;\n    }\n\n    chooseRecipients() {\n        app.modal.show(AddRecipientModal, {\n            selectedRecipients: this.composer.fields.recipients,\n            onsubmit: (recipients) => {\n                this.composer.fields.recipients = recipients;\n\n                // Focus on recipient autocomplete field.\n                this.$('.RecipientsInput').focus();\n            },\n        });\n    }\n\n    headerItems() {\n        let items = super.headerItems();\n\n        if (app.session.user && app.forum.attribute('canStartPrivateDiscussion')) {\n            const recipients = this.composer.fields.recipients.toArray();\n\n            items.add(\n                'recipients',\n                <a className=\"PrivateDiscussionComposer-changeRecipients\" onclick={this.chooseRecipients.bind(this)}>\n                    {recipients.length ? (\n                        recipientCountLabel(recipients.length)\n                    ) : (\n                        <span className=\"RecipientLabel none\">{app.translator.trans('aravinth-boybu.forum.buttons.add_recipients')}</span>\n                    )}\n                </a>,\n                5\n            );\n        }\n\n        return items;\n    }\n\n    addDefaultRecipients(username) {\n        const user = app.store.getBy('users', 'username', username);\n\n        this.composer.fields.recipients.add('users:' + app.session.user.id(), app.session.user);\n\n        if (user.id() !== app.session.user.id()) {\n            this.composer.fields.recipients.add('users:' + user.id(), user);\n        }\n    }\n\n    onsubmit() {\n        this.loading = true;\n\n        const recipients = this.composer.fields.recipients.toArray();\n\n        if (recipients.length < 2) {\n            this.chooseRecipients();\n\n            this.loading = false;\n        } else {\n            const data = this.data();\n\n            app.store\n                .createRecord('discussions')\n                .save(data)\n                .then((discussion) => {\n                    if (app.cache.discussionList) {\n                        app.cache.discussionList.refresh();\n                    }\n                    m.route.set(app.route.discussion(discussion));\n\n                    app.composer.hide();\n                }, this.loaded.bind(this));\n        }\n    }\n}","import DiscussionList from 'flarum/forum/components/DiscussionList';\n\nexport default class PrivateDiscussionList extends DiscussionList {}\n","import PrivateDiscussionComposer from './PrivateDiscussionComposer';\nimport PrivateDiscussionList from './PrivateDiscussionList';\n\nexport const discussions = {\n    PrivateDiscussionComposer: PrivateDiscussionComposer,\n    PrivateDiscussionList: PrivateDiscussionList,\n};\n","import routes from './routes';\nimport PrivateDiscussionsPage from './PrivateDiscussionsPage';\n\nexport default (app) => {\n    routes(app);\n    PrivateDiscussionsPage(app);\n};\n","import type * as Mithril from 'mithril';\nimport username from 'flarum/common/helpers/username';\nimport User from 'flarum/common/models/User';\nimport Group from 'flarum/common/models/Group';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport classList from 'flarum/common/utils/classList';\nimport app from 'flarum/forum/app';\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\n\nexport interface IRecipientLabelAttrs extends ComponentAttrs, Mithril.Attributes {\n    recipient: User | Group;\n    link: string;\n}\n\nexport default class RecipientLabel extends Component<IRecipientLabelAttrs> {\n    view(vnode: Mithril.Vnode) {\n        const { recipient, link, ...newAttrs } = this.attrs;\n\n        newAttrs.style = newAttrs.style || {};\n        newAttrs.className = classList('RecipientLabel', newAttrs?.className);\n\n        if (link && recipient instanceof User) {\n            newAttrs.href = app.route.user(recipient);\n        }\n\n        let label: string;\n\n        if (recipient instanceof User) {\n            label = username(recipient);\n\n            if (!newAttrs.href && recipient.id() !== app?.session?.user?.id()) {\n                newAttrs.href = app.route.user(recipient);\n            }\n        } else if (recipient instanceof Group) {\n            return <span class={newAttrs.className}>{recipient.namePlural()}</span>;\n        } else {\n            newAttrs.className += ' none';\n            label = app.translator.trans('flarum.core.lib.username.deleted_text');\n        }\n\n        return <LinkButton {...newAttrs}>{label}</LinkButton>;\n    }\n}\n","export default function recipientCountLabel(count, attrs = {}) {\n    attrs.style = attrs.style || {};\n    attrs.className = 'RecipientLabel ' + (attrs.className || '');\n\n    var label = app.translator.trans('aravinth-boybu.forum.labels.recipients', { count });\n\n    return m('span', attrs, <span className=\"RecipientLabel-text\">{label}</span>);\n}\n","import Group from 'flarum/common/models/Group';\nimport User from 'flarum/common/models/User';\nimport classList from 'flarum/common/utils/classList';\nimport RecipientLabel from './RecipientLabel';\n\nexport default function recipientsLabel(recipients?: (User | Group)[], attrs: Record<string, unknown> = {}): JSX.Element {\n    const { link, className, ...otherAttrs } = attrs;\n\n    otherAttrs.className = classList('RecipientsLabel', className);\n\n    return (\n        <span {...otherAttrs}>\n            {recipients?.map((recipient) => {\n                const type = recipient instanceof User ? 'u' : 'g';\n\n                return <RecipientLabel key={`${type}-${recipient.id()}`} recipient={recipient} link={link} />;\n            })}\n            {!recipients && <RecipientLabel />}\n        </span>\n    );\n}\n","import IndexPage from 'flarum/forum/components/IndexPage';\nimport PrivateDiscussionsUserPage from './PrivateDiscussionsUserPage';\n\nexport default (app) => {\n    app.routes.boybuUserPrivate = { path: '/u/:username/private', component: PrivateDiscussionsUserPage };\n    app.routes.boybuPrivate = { path: '/private', component: IndexPage };\n};\n","import app from 'flarum/forum/app';\nimport Search from 'flarum/forum/components/Search';\nimport UserSearchSource from './sources/UserSearchSource';\nimport GroupSearchSource from './sources/GroupSearchSource';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport classList from 'flarum/common/utils/classList';\nimport extractText from 'flarum/common/utils/extractText';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport RecipientLabel from '../pages/labels/RecipientLabel';\nimport User from 'flarum/common/models/User';\nimport Group from 'flarum/common/models/Group';\nimport Tooltip from 'flarum/common/components/Tooltip';\n\nexport default class RecipientSearch extends Search {\n    /**\n     * Used to prevent duplicate IDs. Doesn't remove the possibility, but is extremely low.\n     */\n    inputUuid;\n\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.inputUuid = Math.random().toString(36).substring(2);\n    }\n\n    oncreate(vnode) {\n        super.oncreate(vnode);\n\n        const $search = this;\n\n        this.$('.Search-results').on('click', (e) => {\n            const target = this.$('.SearchResult.active');\n\n            $search.addRecipient(target.data('index'));\n            $search.$('.RecipientsInput').focus();\n        });\n\n        this.$('.Search-results').on('touchstart', (e) => {\n            const target = this.$(e.target.parentNode);\n\n            $search.addRecipient(target.data('index'));\n            $search.$('.RecipientsInput').focus();\n        });\n\n        $('.RecipientsInput')\n            .on('input', () => {\n                clearTimeout(this.typingTimer);\n                this.doSearch = false;\n                this.typingTimer = setTimeout(() => {\n                    this.doSearch = true;\n                    m.redraw();\n                }, 900);\n            })\n            .on('keydown', () => {\n                clearTimeout(this.typingTimer);\n            });\n\n        super.oncreate(vnode);\n    }\n\n    view() {\n        if (typeof this.state.getValue() === 'undefined') {\n            this.state.setValue('');\n        }\n\n        const loading = this.state.getValue() && this.state.getValue().length >= 3;\n\n        if (!this.sources) {\n            this.sources = this.sourceItems().toArray();\n        }\n\n        return (\n            <div role=\"search\" className=\"Search\">\n                <div className=\"RecipientsInput-selected RecipientsLabel\" aria-live=\"polite\">\n                    <h4>{app.translator.trans('aravinth-boybu.forum.modal.labels.selected_users')}</h4>\n                    <p>{app.translator.trans('aravinth-boybu.forum.modal.help.selected_users')}</p>\n\n                    {this.attrs\n                        .selected()\n                        .toArray()\n                        .map((recipient) => {\n                            return (\n                                <Tooltip text={app.translator.trans('aravinth-boybu.forum.modal.help.click_user_to_remove_tooltip')}>\n                                    <RecipientLabel data-container=\"body\" recipient={recipient} onclick={(e) => this.removeRecipient(recipient, e)} />\n                                </Tooltip>\n                            );\n                        })}\n                </div>\n\n                <div className=\"Form-group\">\n                    <label for={`boybu-addrecipient-search-input-${this.inputUuid}`}>\n                        {app.translator.trans('aravinth-boybu.forum.modal.labels.search_field')}\n                    </label>\n\n                    <div className=\"AddRecipientModal-form-input Search-input\">\n                        <input\n                            id={`boybu-addrecipient-search-input-${this.inputUuid}`}\n                            className={classList('RecipientsInput', 'FormControl', {\n                                open: !!this.state.getValue(),\n                                focused: !!this.state.getValue(),\n                                active: !!this.state.getValue(),\n                                loading: !!this.loadingSources,\n                            })}\n                            oncreate={(vnode) => vnode.dom.focus()}\n                            type=\"search\"\n                            placeholder={extractText(app.translator.trans('aravinth-boybu.forum.input.search_recipients'))}\n                            value={this.state.getValue()}\n                            oninput={(e) => this.state.setValue(e.target.value)}\n                            onfocus={() => (this.hasFocus = true)}\n                            onblur={() => (this.hasFocus = false)}\n                        />\n                        <ul\n                            className={classList('Dropdown-menu', 'Search-results', 'fade', {\n                                in: !!loading,\n                            })}\n                        >\n                            {!this.doSearch\n                                ? LoadingIndicator.component({ size: 'tiny', className: 'Button Button--icon Button--link' })\n                                : this.sources.map((source) => source.view(this.state.getValue()))}\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    /**\n     * Build an item list of SearchSources.\n     *\n     * @return {ItemList}\n     */\n    sourceItems() {\n        const items = new ItemList();\n\n        // Add user source based on permissions.\n        if (\n            (!this.attrs.discussion && app.forum.attribute('canStartPrivateDiscussionWithUsers')) ||\n            (this.attrs.discussion && this.attrs.discussion.canEditUserRecipients())\n        ) {\n            items.add('users', new UserSearchSource());\n        }\n\n        // Add group source based on permissions.\n        if (\n            (!this.attrs.discussion && app.forum.attribute('canStartPrivateDiscussionWithGroups')) ||\n            (this.attrs.discussion && this.attrs.discussion.canEditGroupRecipients())\n        ) {\n            items.add('groups', new GroupSearchSource());\n        }\n\n        return items;\n    }\n\n    /**\n     * Adds a recipient.\n     *\n     * @param value\n     */\n    addRecipient(value) {\n        let values = value.split(':'),\n            type = values[0],\n            id = values[1];\n\n        let recipient = this.findRecipient(type, id);\n\n        this.attrs.selected().add(value, recipient);\n\n        this.state.clear();\n    }\n\n    /**\n     * Removes a recipient.\n     *\n     * @param recipient\n     */\n    removeRecipient(recipient, e) {\n        e.preventDefault();\n\n        let type;\n\n        if (recipient instanceof User) {\n            type = 'users';\n        }\n        if (recipient instanceof Group) {\n            type = 'groups';\n        }\n\n        this.attrs.selected().remove(type + ':' + recipient.id());\n    }\n\n    /**\n     * Loads a recipient from the global store.\n     *\n     * @param store\n     * @param id\n     * @returns {Model}\n     */\n    findRecipient(store, id) {\n        return app.store.getById(store, id);\n    }\n}\n","import highlight from 'flarum/common/helpers/highlight';\n\nexport default class GroupSearchSource {\n    search(query) {\n        return app.store.find('groups', {\n            filter: { q: query },\n            page: { limit: 5 },\n        });\n    }\n\n    view(query) {\n        query = query.toLowerCase();\n\n        const results = app.store.all('groups').filter((group) => group.namePlural().toLowerCase().substr(0, query.length) === query);\n\n        if (!results.length) return '';\n\n        return [\n            <li className=\"Dropdown-header\">{app.translator.trans('aravinth-boybu.forum.search.headings.groups')}</li>,\n            results.map((group) => {\n                const groupName = group.namePlural();\n                var name = highlight(groupName, query);\n\n                return (\n                    <li className=\"SearchResult\" data-index={'groups:' + group.id()}>\n                        <a data-index={'groups:' + group.id()}>\n                            <span class=\"groupName\">{name}</span>\n                        </a>\n                    </li>\n                );\n            }),\n        ];\n    }\n}\n","import highlight from 'flarum/common/helpers/highlight';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\n\nexport default class UserSearchSource {\n    view(query) {\n        if (query.length < 3 || this.loading) return;\n\n        if (!app.cache.boybuResults) {\n            app.cache.boybuResults = [];\n        }\n\n        this.query = query;\n\n        if (!app.cache.boybuResults[this.query]) {\n            this.loading = true;\n\n            app.cache.boybuResults[this.query] = [];\n            app.store\n                .find('users', {\n                    filter: { q: this.query + ' allows-pd' },\n                    page: { limit: 5 },\n                })\n                .then(this.pushResults.bind(this));\n        } else\n            return [\n                <li className=\"Dropdown-header\">{app.translator.trans('core.forum.search.users_heading')}</li>,\n                app.cache.boybuResults[this.query].map((user) => {\n                    const name = username(user);\n                    const children = [highlight(name.text, this.query)];\n\n                    return (\n                        <li className=\"SearchResult\" data-index={'users:' + user.id()}>\n                            <a data-index={'users:' + user.id()}>\n                                {avatar(user)}\n                                {{ ...name, text: undefined, children }}\n                            </a>\n                        </li>\n                    );\n                }),\n            ];\n    }\n\n    pushResults(results) {\n        results.payload.data.map((result) => {\n            var user = app.store.getById('users', result.id);\n            app.cache.boybuResults[this.query].push(user);\n        });\n        this.loading = false;\n        m.redraw();\n    }\n}\n","import DiscussionListState from 'flarum/forum/states/DiscussionListState';\n\nexport default class PrivateDiscussionListState extends DiscussionListState {}\n","module.exports = flarum.core.compat['common/Component'];","module.exports = flarum.core.compat['common/Model'];","module.exports = flarum.core.compat['common/components/Badge'];","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/components/Dropdown'];","module.exports = flarum.core.compat['common/components/LinkButton'];","module.exports = flarum.core.compat['common/components/LoadingIndicator'];","module.exports = flarum.core.compat['common/components/Modal'];","module.exports = flarum.core.compat['common/components/Switch'];","module.exports = flarum.core.compat['common/components/Tooltip'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/helpers/avatar'];","module.exports = flarum.core.compat['common/helpers/highlight'];","module.exports = flarum.core.compat['common/helpers/listItems'];","module.exports = flarum.core.compat['common/helpers/username'];","module.exports = flarum.core.compat['common/models/Discussion'];","module.exports = flarum.core.compat['common/models/Group'];","module.exports = flarum.core.compat['common/models/User'];","module.exports = flarum.core.compat['common/utils/ItemList'];","module.exports = flarum.core.compat['common/utils/Stream'];","module.exports = flarum.core.compat['common/utils/classList'];","module.exports = flarum.core.compat['common/utils/extractText'];","module.exports = flarum.core.compat['forum/app'];","module.exports = flarum.core.compat['forum/components/DiscussionComposer'];","module.exports = flarum.core.compat['forum/components/DiscussionHero'];","module.exports = flarum.core.compat['forum/components/DiscussionList'];","module.exports = flarum.core.compat['forum/components/DiscussionListItem'];","module.exports = flarum.core.compat['forum/components/DiscussionPage'];","module.exports = flarum.core.compat['forum/components/EventPost'];","module.exports = flarum.core.compat['forum/components/IndexPage'];","module.exports = flarum.core.compat['forum/components/LogInModal'];","module.exports = flarum.core.compat['forum/components/Notification'];","module.exports = flarum.core.compat['forum/components/NotificationGrid'];","module.exports = flarum.core.compat['forum/components/Search'];","module.exports = flarum.core.compat['forum/components/SettingsPage'];","module.exports = flarum.core.compat['forum/components/UserPage'];","module.exports = flarum.core.compat['forum/states/DiscussionListState'];","module.exports = flarum.core.compat['forum/states/SearchState'];","module.exports = flarum.core.compat['forum/utils/DiscussionControls'];","module.exports = flarum.core.compat['forum/utils/UserControls'];"],"sourceRoot":""}